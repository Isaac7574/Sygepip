<div class="space-y-6">
  <!-- Header -->
  <div class="flex items-center justify-between">
    <div>
      <h1 class="text-2xl font-bold text-gray-900">Mon Profil</h1>
      <p class="text-gray-500">Gérez vos informations personnelles et votre sécurité</p>
    </div>
  </div>

  <!-- Profile Card -->
  <div class="card p-6">
    <div class="flex items-start gap-6">
      <!-- Avatar -->
      <div class="w-24 h-24 rounded-full bg-bf-green-500 flex items-center justify-center text-white text-3xl font-bold flex-shrink-0">
        {{ authService.currentUser()?.prenom?.charAt(0) }}{{ authService.currentUser()?.nom?.charAt(0) }}
      </div>
      <!-- Info -->
      <div class="flex-1">
        <div class="flex items-center gap-3 mb-1">
          <h2 class="text-xl font-bold text-gray-900">{{ authService.currentUser()?.prenom }} {{ authService.currentUser()?.nom }}</h2>
          <span class="px-3 py-1 rounded-full text-xs font-medium" [class]="getRoleBadgeClass(authService.currentUser()?.role)">
            {{ getRoleLabel(authService.currentUser()?.role) }}
          </span>
        </div>
        <p class="text-gray-500">{{ authService.currentUser()?.email }}</p>
        <p class="text-sm text-gray-400 mt-1">{{ '@' + authService.currentUser()?.username }}</p>
        @if (authService.currentUser()?.ministereId) {
          <p class="text-sm text-gray-500 mt-2">
            <svg class="w-4 h-4 inline-block mr-1 -mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
            </svg>
            {{ getMinistereNom(authService.currentUser()?.ministereId) }}
          </p>
        }
      </div>
      <!-- Edit Button -->
      <button (click)="toggleEditMode()" class="btn-outline">
        @if (editMode()) {
          <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
          </svg>
          Annuler
        } @else {
          <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
          </svg>
          Modifier
        }
      </button>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- Informations personnelles -->
    <div class="card">
      <div class="p-6 border-b border-gray-100">
        <h3 class="text-lg font-semibold text-gray-900 flex items-center gap-2">
          <svg class="w-5 h-5 text-bf-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
          </svg>
          Informations personnelles
        </h3>
      </div>
      <div class="p-6 space-y-4">
        @if (editMode()) {
          <div class="form-group">
            <label class="form-label">Prénom *</label>
            <input type="text" [(ngModel)]="profileData.prenom" class="form-input" placeholder="Votre prénom">
          </div>
          <div class="form-group">
            <label class="form-label">Nom *</label>
            <input type="text" [(ngModel)]="profileData.nom" class="form-input" placeholder="Votre nom">
          </div>
          <div class="form-group">
            <label class="form-label">Email *</label>
            <input type="email" [(ngModel)]="profileData.email" class="form-input" placeholder="Votre email">
          </div>
          <div class="flex justify-end pt-2">
            <button (click)="saveProfile()" [disabled]="saving()" class="btn-primary">
              {{ saving() ? 'Enregistrement...' : 'Enregistrer' }}
            </button>
          </div>
        } @else {
          <div class="grid grid-cols-2 gap-4">
            <div>
              <p class="text-sm text-gray-500">Prénom</p>
              <p class="font-medium text-gray-900">{{ authService.currentUser()?.prenom || '-' }}</p>
            </div>
            <div>
              <p class="text-sm text-gray-500">Nom</p>
              <p class="font-medium text-gray-900">{{ authService.currentUser()?.nom || '-' }}</p>
            </div>
            <div>
              <p class="text-sm text-gray-500">Email</p>
              <p class="font-medium text-gray-900">{{ authService.currentUser()?.email || '-' }}</p>
            </div>
            <div>
              <p class="text-sm text-gray-500">Nom d'utilisateur</p>
              <p class="font-medium text-gray-900">{{ authService.currentUser()?.username || '-' }}</p>
            </div>
          </div>
        }
      </div>
    </div>

    <!-- Changer le mot de passe -->
    <div class="card">
      <div class="p-6 border-b border-gray-100">
        <h3 class="text-lg font-semibold text-gray-900 flex items-center gap-2">
          <svg class="w-5 h-5 text-bf-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
          </svg>
          Changer le mot de passe
        </h3>
      </div>
      <div class="p-6 space-y-4">
        <div class="form-group">
          <label class="form-label">Mot de passe actuel</label>
          <input type="password" [(ngModel)]="passwordData.currentPassword" class="form-input" placeholder="Votre mot de passe actuel">
        </div>
        <div class="form-group">
          <label class="form-label">Nouveau mot de passe</label>
          <input type="password" [(ngModel)]="passwordData.newPassword" class="form-input" placeholder="Minimum 6 caractères">
        </div>
        <div class="form-group">
          <label class="form-label">Confirmer le nouveau mot de passe</label>
          <input type="password" [(ngModel)]="passwordData.confirmPassword" class="form-input" placeholder="Confirmer le mot de passe">
        </div>
        <div class="flex justify-end pt-2">
          <button (click)="changePassword()" [disabled]="changingPassword()" class="btn-primary">
            {{ changingPassword() ? 'Modification...' : 'Modifier le mot de passe' }}
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Informations du compte -->
  <div class="card">
    <div class="p-6 border-b border-gray-100">
      <h3 class="text-lg font-semibold text-gray-900 flex items-center gap-2">
        <svg class="w-5 h-5 text-bf-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
        Informations du compte
      </h3>
    </div>
    <div class="p-6">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        <div>
          <p class="text-sm text-gray-500">Rôle</p>
          <span class="inline-block mt-1 px-3 py-1 rounded-full text-xs font-medium" [class]="getRoleBadgeClass(authService.currentUser()?.role)">
            {{ getRoleLabel(authService.currentUser()?.role) }}
          </span>
        </div>
        <div>
          <p class="text-sm text-gray-500">Statut</p>
          @if (authService.currentUser()?.actif) {
            <span class="inline-block mt-1 px-3 py-1 rounded-full text-xs font-medium bg-bf-green-100 text-bf-green-700">Actif</span>
          } @else {
            <span class="inline-block mt-1 px-3 py-1 rounded-full text-xs font-medium bg-bf-red-100 text-bf-red-700">Inactif</span>
          }
        </div>
        <div>
          <p class="text-sm text-gray-500">Date de création</p>
          <p class="font-medium text-gray-900 mt-1">{{ formatDate(authService.currentUser()?.createdAt) }}</p>
        </div>
        <div>
          <p class="text-sm text-gray-500">Dernière mise à jour</p>
          <p class="font-medium text-gray-900 mt-1">{{ formatDate(authService.currentUser()?.updatedAt) }}</p>
        </div>
      </div>
    </div>
  </div>
</div>

<app-toast
  [visible]="toastVisible()"
  [message]="toastMessage"
  [type]="toastType"
  (close)="toastVisible.set(false)">
</app-toast>
